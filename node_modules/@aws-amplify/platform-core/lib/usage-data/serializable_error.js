"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.SerializableError = void 0;
const path_1 = __importDefault(require("path"));
const url_1 = require("url");
const os_1 = require("os");
/**
 * Wrapper around Error for serialization for usage metrics
 */
class SerializableError {
    name;
    message;
    details;
    trace;
    // breakdown of filePathRegex:
    // (file:/+)? -> matches optional file url prefix
    // homedir() -> users home directory, replacing \ with /
    // [\\w.\\-_@\\\\/]+ -> matches nested directories and file name
    filePathRegex = new RegExp(`(file:/+)?${(0, os_1.homedir)().replaceAll('\\', '/')}[\\w.\\-_@\\\\/]+`, 'g');
    stackTraceRegex = /^\s*at (?:((?:\[object object\])?[^\\/]+(?: \[as \S+\])?) )?\(?(.*?):(\d+)(?::(\d+))?\)?\s*$/i;
    arnRegex = /arn:[a-z0-9][-.a-z0-9]{0,62}:[A-Za-z0-9][A-Za-z0-9_/.-]{0,62}:[A-Za-z0-9_/.-]{0,63}:[A-Za-z0-9_/.-]{0,63}:[A-Za-z0-9][A-Za-z0-9:_/+=,@.-]{0,1023}/g;
    stackRegex = /amplify-[a-zA-Z0-9-]+/g;
    /**
     * constructor for SerializableError
     */
    constructor(error) {
        this.name =
            'code' in error && error.code
                ? this.sanitize(error.code)
                : error.name;
        this.message = this.anonymizePaths(this.sanitize(error.message));
        this.details =
            'details' in error
                ? this.anonymizePaths(this.sanitize(error.details))
                : undefined;
        this.trace = this.extractStackTrace(error);
    }
    extractStackTrace = (error) => {
        const result = [];
        if (error.stack) {
            const stack = error.stack.split('\n');
            stack.forEach((line) => {
                const match = this.stackTraceRegex.exec(line);
                if (match) {
                    const [, methodName, file, lineNumber, columnNumber] = match;
                    result.push({
                        methodName,
                        file,
                        lineNumber,
                        columnNumber,
                    });
                }
            });
            const processedPaths = this.processPaths(result.map((trace) => trace.file));
            result.forEach((trace, index) => {
                trace.file = processedPaths[index];
            });
        }
        return result;
    };
    anonymizePaths = (str) => {
        let result = str;
        const matches = [...result.matchAll(this.filePathRegex)];
        for (const match of matches) {
            result = result.replace(match[0], this.processPaths([match[0]])[0]);
        }
        return result;
    };
    processPaths = (paths) => {
        return paths.map((tracePath) => {
            let result = tracePath;
            if (this.isURLFilePath(result)) {
                result = (0, url_1.fileURLToPath)(result);
            }
            if (path_1.default.isAbsolute(result)) {
                return path_1.default.relative(process.cwd(), result);
            }
            return result;
        });
    };
    removeARN = (str) => {
        return str?.replace(this.arnRegex, '<escaped ARN>') ?? '';
    };
    removeStackIdentifier = (str) => {
        return str?.replace(this.stackRegex, '<escaped stack>') ?? '';
    };
    sanitize = (str) => {
        let result = str;
        result = this.removeARN(result);
        result = this.removeStackIdentifier(result);
        return result.replaceAll(/["❌]/g, '');
    };
    isURLFilePath = (path) => {
        try {
            new URL(path);
            return path.startsWith('file:');
        }
        catch {
            return false;
        }
    };
}
exports.SerializableError = SerializableError;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2VyaWFsaXphYmxlX2Vycm9yLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vc3JjL3VzYWdlLWRhdGEvc2VyaWFsaXphYmxlX2Vycm9yLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLGdEQUF3QjtBQUN4Qiw2QkFBb0M7QUFDcEMsMkJBQTZCO0FBRTdCOztHQUVHO0FBQ0gsTUFBYSxpQkFBaUI7SUFDNUIsSUFBSSxDQUFTO0lBQ2IsT0FBTyxDQUFTO0lBQ2hCLE9BQU8sQ0FBVTtJQUNqQixLQUFLLENBQVc7SUFFaEIsOEJBQThCO0lBQzlCLGlEQUFpRDtJQUNqRCx3REFBd0Q7SUFDeEQsZ0VBQWdFO0lBQ3hELGFBQWEsR0FBRyxJQUFJLE1BQU0sQ0FDaEMsYUFBYSxJQUFBLFlBQU8sR0FBRSxDQUFDLFVBQVUsQ0FBQyxJQUFJLEVBQUUsR0FBRyxDQUFDLG1CQUFtQixFQUMvRCxHQUFHLENBQ0osQ0FBQztJQUNNLGVBQWUsR0FDckIsK0ZBQStGLENBQUM7SUFDMUYsUUFBUSxHQUNkLG9KQUFvSixDQUFDO0lBQy9JLFVBQVUsR0FBRyx3QkFBd0IsQ0FBQztJQUM5Qzs7T0FFRztJQUNILFlBQVksS0FBWTtRQUN0QixJQUFJLENBQUMsSUFBSTtZQUNQLE1BQU0sSUFBSSxLQUFLLElBQUksS0FBSyxDQUFDLElBQUk7Z0JBQzNCLENBQUMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxJQUFjLENBQUM7Z0JBQ3JDLENBQUMsQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDO1FBQ2pCLElBQUksQ0FBQyxPQUFPLEdBQUcsSUFBSSxDQUFDLGNBQWMsQ0FBQyxJQUFJLENBQUMsUUFBUSxDQUFDLEtBQUssQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFDO1FBQ2pFLElBQUksQ0FBQyxPQUFPO1lBQ1YsU0FBUyxJQUFJLEtBQUs7Z0JBQ2hCLENBQUMsQ0FBQyxJQUFJLENBQUMsY0FBYyxDQUFDLElBQUksQ0FBQyxRQUFRLENB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QUUsZUFBZSxDQUFDLElBQUksRUFBRSxDQUFDO0lBQzVELENBQUMsQ0FBQztJQUVNLHFCQUFxQixHQUFHLENBQUMsR0FBWSxFQUFVLEVBQUU7UUFDdkQsT0FBTyxHQUFHLEVBQUUsT0FBTyxDQUFDLElBQUksQ0FBQyxVQUFVLEVBQUUsaUJBQWlCLENBQUMsSUFBSSxFQUFFLENBQUM7SUFDaEUsQ0FBQyxDQUFDO0lBRU0sUUFBUSxHQUFHLENBQUMsR0FBVyxFQUFFLEVBQUU7UUFDakMsSUFBSSxNQUFNLEdBQUcsR0FBRyxDQUFDO1FBQ2pCLE1BQU0sR0FBRyxJQUFJLENBQUMsU0FBUyxDQUFDLE1BQU0sQ0FBQyxDQUFDO1FBQ2hDLE1BQU0sR0FBRyxJQUFJLENBQUMscUJBQXFCLENBQUMsTUFBTSxDQUFDLENBQUM7UUFDNUMsT0FBTyxNQUFNLENBQUMsVUFBVSxDQUFDLE9BQU8sRUFBRSxFQUFFLENBQUMsQ0FBQztJQUN4QyxDQUFDLENBQUM7SUFFTSxhQUFhLEdBQUcsQ0FBQyxJQUFZLEVBQVcsRUFBRTtRQUNoRCxJQUFJLENBQUM7WUFDSCxJQUFJLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQztZQUNkLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUMsQ0FBQztRQUNsQyxDQUFDO1FBQUMsTUFBTSxDQUFDO1lBQ1AsT0FBTyxLQUFLLENBQUM7UUFDZixDQUFDO0lBQ0gsQ0FBQyxDQUFDO0NBQ0g7QUE1R0QsOENBNEdDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5pbXBvcnQgeyBmaWxlVVJMVG9QYXRoIH0gZnJvbSAndXJsJztcbmltcG9ydCB7IGhvbWVkaXIgfSBmcm9tICdvcyc7XG5cbi8qKlxuICogV3JhcHBlciBhcm91bmQgRXJyb3IgZm9yIHNlcmlhbGl6YXRpb24gZm9yIHVzYWdlIG1ldHJpY3NcbiAqL1xuZXhwb3J0IGNsYXNzIFNlcmlhbGl6YWJsZUVycm9yIHtcbiAgbmFtZTogc3RyaW5nO1xuICBtZXNzYWdlOiBzdHJpbmc7XG4gIGRldGFpbHM/OiBzdHJpbmc7XG4gIHRyYWNlPzogVHJhY2VbXTtcblxuICAvLyBicmVha2Rvd24gb2YgZmlsZVBhdGhSZWdleDpcbiAgLy8gKGZpbGU6LyspPyAtPiBtYXRjaGVzIG9wdGlvbmFsIGZpbGUgdXJsIHByZWZpeFxuICAvLyBob21lZGlyKCkgLT4gdXNlcnMgaG9tZSBkaXJlY3RvcnksIHJlcGxhY2luZyBcXCB3aXRoIC9cbiAgLy8gW1xcXFx3LlxcXFwtX0BcXFxcXFxcXC9dKyAtPiBtYXRjaGVzIG5lc3RlZCBkaXJlY3RvcmllcyBhbmQgZmlsZSBuYW1lXG4gIHByaXZhdGUgZmlsZVBhdGhSZWdleCA9IG5ldyBSZWdFeHAoXG4gICAgYChmaWxlOi8rKT8ke2hvbWVkaXIoKS5yZXBsYWNlQWxsKCdcXFxcJywgJy8nKX1bXFxcXHcuXFxcXC1fQFxcXFxcXFxcL10rYCxcbiAgICAnZycsXG4gICk7XG4gIHByaXZhdGUgc3RhY2tUcmFjZVJlZ2V4ID1cbiAgICAvXlxccyphdCAoPzooKD86XFxbb2JqZWN0IG9iamVjdFxcXSk/W15cXFxcL10rKD86IFxcW2FzIFxcUytcXF0pPykgKT9cXCg/KC4qPyk6KFxcZCspKD86OihcXGQrKSk/XFwpP1xccyokL2k7XG4gIHByaXZhdGUgYXJuUmVnZXggPVxuICAgIC9hcm46W2EtejAtOV1bLS5hLXowLTldezAsNjJ9OltBLVphLXowLTldW0EtWmEtejAtOV8vLi1dezAsNjJ9OltBLVphLXowLTlfLy4tXXswLDYzfTpbQS1aYS16MC05Xy8uLV17MCw2M306W0EtWmEtejAtOV1bQS1aYS16MC05Ol8vKz0sQC4tXXswLDEwMjN9L2c7XG4gIHByaXZhdGUgc3RhY2tSZWdleCA9IC9hbXBsaWZ5LVthLXpBLVowLTktXSsvZztcbiAgLyoqXG4gICAqIGNvbnN0cnVjdG9yIGZvciBTZXJpYWxpemFibGVFcnJvclxuICAgKi9cbiAgY29uc3RydWN0b3IoZXJyb3I6IEVycm9yKSB7XG4gICAgdGhpcy5uYW1lID1cbiAgICAgICdjb2RlJyBpbiBlcnJvciAmJiBlcnJvci5jb2RlXG4gICAgICAgID8gdGhpcy5zYW5pdGl6ZShlcnJvci5jb2RlIGFzIHN0cmluZylcbiAgICAgICAgOiBlcnJvci5uYW1lO1xuICAgIHRoaXMubWVzc2FnZSA9IHRoaXMuYW5vbnltaXplUGF0aHModGhpcy5zYW5pdGl6ZShlcnJvci5tZXNzYWdlKSk7XG4gICAgdGhpcy5kZXRhaWxzID1cbiAgICAgICdkZXRhaWxzJyBpbiBlcnJvclxuICAgICAgICA/IHRoaXMuYW5vbnltaXplUGF0aHModGhpcy5zYW5pdGl6ZShlcnJvci5kZXRhaWxzIGFzIHN0cmluZykpXG4gICAgICAgIDogdW5kZWZpbmVkO1xuICAgIHRoaXMudHJhY2UgPSB0aGlzLmV4dHJhY3RTdGFja1RyYWNlKGVycm9yKTtcbiAgfVxuXG4gIHByaXZhdGUgZXh0cmFjdFN0YWNrVHJhY2UgPSAoZXJyb3I6IEVycm9yKTogVHJhY2VbXSA9PiB7XG4gICAgY29uc3QgcmVzdWx0OiBUcmFjZVtdID0gW107XG4gICAgaWYgKGVycm9yLnN0YWNrKSB7XG4gICAgICBjb25zdCBzdGFjayA9IGVycm9yLnN0YWNrLnNwbGl0KCdcXG4nKTtcbiAgICAgIHN0YWNrLmZvckVhY2goKGxpbmUpID0+IHtcbiAgICAgICAgY29uc3QgbWF0Y2ggPSB0aGlzLnN0YWNrVHJhY2VSZWdleC5leGVjKGxpbmUpO1xuICAgICAgICBpZiAobWF0Y2gpIHtcbiAgICAgICAgICBjb25zdCBbLCBtZXRob2ROYW1lLCBmaWxlLCBsaW5lTnVtYmVyLCBjb2x1bW5OdW1iZXJdID0gbWF0Y2g7XG4gICAgICAgICAgcmVzdWx0LnB1c2goe1xuICAgICAgICAgICAgbWV0aG9kTmFtZSxcbiAgICAgICAgICAgIGZpbGUsXG4gICAgICAgICAgICBsaW5lTnVtYmVyLFxuICAgICAgICAgICAgY29sdW1uTnVtYmVyLFxuICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgICB9KTtcbiAgICAgIGNvbnN0IHByb2Nlc3NlZFBhdGhzID0gdGhpcy5wcm9jZXNzUGF0aHMoXG4gICAgICAgIHJlc3VsdC5tYXAoKHRyYWNlKSA9PiB0cmFjZS5maWxlKSxcbiAgICAgICk7XG4gICAgICByZXN1bHQuZm9yRWFjaCgodHJhY2UsIGluZGV4KSA9PiB7XG4gICAgICAgIHRyYWNlLmZpbGUgPSBwcm9jZXNzZWRQYXRoc1tpbmRleF07XG4gICAgICB9KTtcbiAgICB9XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfTtcblxuICBwcml2YXRlIGFub255bWl6ZVBhdGhzID0gKHN0cjogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICBsZXQgcmVzdWx0ID0gc3RyO1xuICAgIGNvbnN0IG1hdGNoZXMgPSBbLi4ucmVzdWx0Lm1hdGNoQWxsKHRoaXMuZmlsZVBhdGhSZWdleCldO1xuICAgIGZvciAoY29uc3QgbWF0Y2ggb2YgbWF0Y2hlcykge1xuICAgICAgcmVzdWx0ID0gcmVzdWx0LnJlcGxhY2UobWF0Y2hbMF0sIHRoaXMucHJvY2Vzc1BhdGhzKFttYXRjaFswXV0pWzBdKTtcbiAgICB9XG5cbiAgICByZXR1cm4gcmVzdWx0O1xuICB9O1xuXG4gIHByaXZhdGUgcHJvY2Vzc1BhdGhzID0gKHBhdGhzOiBzdHJpbmdbXSk6IHN0cmluZ1tdID0+IHtcbiAgICByZXR1cm4gcGF0aHMubWFwKCh0cmFjZVBhdGgpID0+IHtcbiAgICAgIGxldCByZXN1bHQgPSB0cmFjZVBhdGg7XG4gICAgICBpZiAodGhpcy5pc1VSTEZpbGVQYXRoKHJlc3VsdCkpIHtcbiAgICAgICAgcmVzdWx0ID0gZmlsZVVSTFRvUGF0aChyZXN1bHQpO1xuICAgICAgfVxuICAgICAgaWYgKHBhdGguaXNBYnNvbHV0ZShyZXN1bHQpKSB7XG4gICAgICAgIHJldHVybiBwYXRoLnJlbGF0aXZlKHByb2Nlc3MuY3dkKCksIHJlc3VsdCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfSk7XG4gIH07XG5cbiAgcHJpdmF0ZSByZW1vdmVBUk4gPSAoc3RyPzogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICByZXR1cm4gc3RyPy5yZXBsYWNlKHRoaXMuYXJuUmVnZXgsICc8ZXNjYXBlZCBBUk4+JykgPz8gJyc7XG4gIH07XG5cbiAgcHJpdmF0ZSByZW1vdmVTdGFja0lkZW50aWZpZXIgPSAoc3RyPzogc3RyaW5nKTogc3RyaW5nID0+IHtcbiAgICByZXR1cm4gc3RyPy5yZXBsYWNlKHRoaXMuc3RhY2tSZWdleCwgJzxlc2NhcGVkIHN0YWNrPicpID8/ICcnO1xuICB9O1xuXG4gIHByaXZhdGUgc2FuaXRpemUgPSAoc3RyOiBzdHJpbmcpID0+IHtcbiAgICBsZXQgcmVzdWx0ID0gc3RyO1xuICAgIHJlc3VsdCA9IHRoaXMucmVtb3ZlQVJOKHJlc3VsdCk7XG4gICAgcmVzdWx0ID0gdGhpcy5yZW1vdmVTdGFja0lkZW50aWZpZXIocmVzdWx0KTtcbiAgICByZXR1cm4gcmVzdWx0LnJlcGxhY2VBbGwoL1tcIuKdjF0vZywgJycpO1xuICB9O1xuXG4gIHByaXZhdGUgaXNVUkxGaWxlUGF0aCA9IChwYXRoOiBzdHJpbmcpOiBib29sZWFuID0+IHtcbiAgICB0cnkge1xuICAgICAgbmV3IFVSTChwYXRoKTtcbiAgICAgIHJldHVybiBwYXRoLnN0YXJ0c1dpdGgoJ2ZpbGU6Jyk7XG4gICAgfSBjYXRjaCB7XG4gICAgICByZXR1cm4gZmFsc2U7XG4gICAgfVxuICB9O1xufVxuXG50eXBlIFRyYWNlID0ge1xuICBtZXRob2ROYW1lOiBzdHJpbmc7XG4gIGZpbGU6IHN0cmluZztcbiAgbGluZU51bWJlcjogc3RyaW5nO1xuICBjb2x1bW5OdW1iZXI6IHN0cmluZztcbn07XG4iXX0=